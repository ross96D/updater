<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
    </head>
    <script>
    </script>
    <body>
        <button
            id="login-btn"
            class="icon-btn"
            onclick="openModal()"
        >
            <svg
                id="icon-login"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                class="hide"
            >
                <path
                    d="M14 19.2857L15.8 21L20 17M4 21C4 17.134 7.13401 14 11 14C12.4872 14
                        13.8662 14.4638 15 15.2547M15 7C15 9.20914 13.2091 11 11 11C8.79086
                        11 7 9.20914 7 7C7 4.79086 8.79086 3 11 3C13.2091 3 15 4.79086 15 7Z"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
            </svg>

            <svg
                id="icon-logout"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
            >
                <path
                    d="M15 16L20 21M20 16L15 21M4 21C4 17.134 7.13401 14 11 14M15 7C15 9.20914
                        13.2091 11 11 11C8.79086 11 7 9.20914 7 7C7 4.79086 8.79086 3 11 3C13.2091
                        3 15 4.79086 15 7Z"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
            </svg>
        </button>

        <h2 style="text-align: center">Log file</h2>
        <div id="console" class="container"></div>
    </body>
    <div id="modal" class="modal hide">
        <div id="modal-body" class="modal-body">
            <h2>User is not logged. Please introduce the credentials</h2>
            <div id="form" style="display: grid;">
                <label for="input_name">Name</label>
                <input onkeypress="hideError()" id="input_name" type="text" ></input>
                <label for="input_password">Password</label>
                <input onkeypress="hideError()" id="input_password" type="text"></input>
                <div>
                    <button type="button" onclick="sendForm()">Login</button>
                    <button type="button" onclick="closeModal()">Close</button>
                </div>
                <label id="credentials_error" class="error hide">Wrong credentials</label>
            </div>
        </div>
    </div>
    <style>
        :root {
            --color-primary: rgb(81 91 146);
            --color-surface-tint: rgb(81 91 146);
            --color-on-primary: rgb(255 255 255);
            --color-primary-container: rgb(222 224 255);
            --color-on-primary-container: rgb(57 67 121);
            --color-secondary: rgb(91 93 114);
            --color-on-secondary: rgb(255 255 255);
            --color-secondary-container: rgb(224 225 249);
            --color-on-secondary-container: rgb(67 70 89);
            --color-tertiary: rgb(119 83 109);
            --color-on-tertiary: rgb(255 255 255);
            --color-tertiary-container: rgb(255 215 241);
            --color-on-tertiary-container: rgb(93 60 85);
            --color-error: rgb(186 26 26);
            --color-on-error: rgb(255 255 255);
            --color-error-container: rgb(255 218 214);
            --color-on-error-container: rgb(147 0 10);
            --color-background: rgb(251 248 255);
            --color-on-background: rgb(27 27 33);
            --color-surface: rgb(251 248 255);
            --color-on-surface: rgb(27 27 33);
            --color-surface-variant: rgb(227 225 236);
            --color-on-surface-variant: rgb(70 70 79);
            --color-outline: rgb(118 118 128);
            --color-outline-variant: rgb(199 197 208);
            --color-shadow: rgb(0 0 0);
            --color-scrim: rgb(0 0 0);
            --color-inverse-surface: rgb(48 48 54);
            --color-inverse-on-surface: rgb(242 239 247);
            --color-inverse-primary: rgb(186 195 255);
            --color-primary-fixed: rgb(222 224 255);
            --color-on-primary-fixed: rgb(11 21 75);
            --color-primary-fixed-dim: rgb(186 195 255);
            --color-on-primary-fixed-variant: rgb(57 67 121);
            --color-secondary-fixed: rgb(224 225 249);
            --color-on-secondary-fixed: rgb(24 26 44);
            --color-secondary-fixed-dim: rgb(195 197 221);
            --color-on-secondary-fixed-variant: rgb(67 70 89);
            --color-tertiary-fixed: rgb(255 215 241);
            --color-on-tertiary-fixed: rgb(45 18 40);
            --color-tertiary-fixed-dim: rgb(230 186 215);
            --color-on-tertiary-fixed-variant: rgb(93 60 85);
            --color-surface-dim: rgb(219 217 224);
            --color-surface-bright: rgb(251 248 255);
            --color-surface-container-lowest: rgb(255 255 255);
            --color-surface-container-low: rgb(245 242 250);
            --color-surface-container: rgb(239 237 244);
            --color-surface-container-high: rgb(233 231 239);
            --color-surface-container-highest: rgb(228 225 233);
        }
        html {
            background: var(--color-background);
            color: var(--color-on-background);
            margin: 0.1rem;
        }
        body {
            width: 70%;
            margin: auto;
        }
        @keyframes show {
          from { display: none; opacity: 0; }
          to { display: block; opacity: 1;}
        }
        button {
            background: var(--color-primary);
            color: var(--color-on-primary);
            border-radius: 0.5rem;
            border: none;
            transition: all 0.1s;
            min-height: 1.5rem;
            min-width: 1.5rem;
            margin: 0.1rem;
            font-size: medium;
            padding-left: 0.5rem;
            padding-right: 0.5rem;
            padding-top: 0.1rem;
            padding-bottom: 0.2rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            transition: all .2s;
        }
        button:active {
            scale: 0.9;
        }
        button:foucus {
            border-color: var(--color-primary);
            outline: 0.1rem solid var(--color-primary);
        }
        button:hover {
            cursor: pointer;
            background: var(--color-primary-container);
            color: var(--color-on-primary-container);
            scale: 1.1;
        }
        input {
            background: var(--color-surface);
            color: var(--color-on-surface);
            font-size: medium;
            border-radius: 0.3rem;
            border-color: var(--color-outline);
            margin: 0.1rem;
        }
        input:focus {
            border-color: var(--color-outline);
            border-color: var(--color-primary);
            outline: 0.1rem solid var(--color-primary);
        }
        .error {
            background: var(--color-error);
            color: var(--color-on-error);
            padding-left: 0.5rem;
            padding-right: 0.5rem;
            padding-top: 0.1rem;
            padding-bottom: 0.2rem;
            border-radius: 0.5rem;
        }
        .container {
            font-family: monospace;
            border: solid 0.15rem var(--color-tertiary);
            border-radius: 0.5rem;
            padding: 1rem;
            background: var(--color-primary-container);
            color: var(--color-on-primary-container);
            box-shadow: 0 0 0.5rem rgba(0,0,0,0.6);
        }
        .modal {
            position: fixed;
            inset: 0;
            z-index: 10000;
            background-color: rgba(0, 0, 0, 0.75);
            padding-top: 5rem;
        }
        .hide {
            display: none;
        }
        .show {
            animation: show .2s;
            display: block;
        }
        .modal-body {
            border-radius: 0.5rem;
            border: 0.2rem solid var(--color-primary);
            padding: 0.5rem;
            background: var(--color-surface);
            color: var(--color-on-surface);
            margin: auto;
            max-width: 30rem;
            width: 90%;
            transition: all 1s;
        }
        .icon-btn {
            position: fixed;
            top: 1rem;
            left: 1rem;
            background: var(--color-primary);
            color: var(--color-on-primary);
            border: none;
            border-radius: 50%;
            width: 2.5rem;
            height: 2.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            transition: all 0.2s ease;
            stroke: var(--color-on-primary);
        }
        .icon-btn:hover {
            background: var(--color-primary-container);
            color: var(--color-on-primary-container);
            scale: 1.1;
            stroke: var(--color-on-primary-container);
        }
        .icon-btn:active {
            scale: 0.9;
        }
    </style>
    <script>
        "use strict";
        let style = getComputedStyle(document.body);

        var __makeTemplateObject =
            (this && this.__makeTemplateObject) ||
            function (cooked, raw) {
                if (Object.defineProperty) {
                    Object.defineProperty(cooked, "raw", { value: raw });
                } else {
                    cooked.raw = raw;
                }
                return cooked;
            };
        var PacketKind;
        (function (PacketKind) {
            PacketKind[(PacketKind["EOS"] = 0)] = "EOS";
            PacketKind[(PacketKind["Text"] = 1)] = "Text";
            PacketKind[(PacketKind["Incomplete"] = 2)] = "Incomplete";
            PacketKind[(PacketKind["ESC"] = 3)] = "ESC";
            PacketKind[(PacketKind["Unknown"] = 4)] = "Unknown";
            PacketKind[(PacketKind["SGR"] = 5)] = "SGR";
            PacketKind[(PacketKind["OSCURL"] = 6)] = "OSCURL";
        })(PacketKind || (PacketKind = {}));
        class AnsiUp {
            constructor() {
                this.VERSION = "6.0.5";
                this.setup_palettes();
                this._use_classes = false;
                this.bold = false;
                this.faint = false;
                this.italic = false;
                this.underline = false;
                this.fg = this.bg = null;
                this._buffer = "";
                this._url_allowlist = { http: 1, https: 1 };
                this._escape_html = true;
                this.boldStyle = "font-weight:bold";
                this.faintStyle = "opacity:0.7";
                this.italicStyle = "font-style:italic";
                this.underlineStyle = "text-decoration:underline";
            }
            set use_classes(arg) {
                this._use_classes = arg;
            }
            get use_classes() {
                return this._use_classes;
            }
            set url_allowlist(arg) {
                this._url_allowlist = arg;
            }
            get url_allowlist() {
                return this._url_allowlist;
            }
            set escape_html(arg) {
                this._escape_html = arg;
            }
            get escape_html() {
                return this._escape_html;
            }
            set boldStyle(arg) {
                this._boldStyle = arg;
            }
            get boldStyle() {
                return this._boldStyle;
            }
            set faintStyle(arg) {
                this._faintStyle = arg;
            }
            get faintStyle() {
                return this._faintStyle;
            }
            set italicStyle(arg) {
                this._italicStyle = arg;
            }
            get italicStyle() {
                return this._italicStyle;
            }
            set underlineStyle(arg) {
                this._underlineStyle = arg;
            }
            get underlineStyle() {
                return this._underlineStyle;
            }
            setup_palettes() {
                this.ansi_colors = [
                    [
                        { rgb: [10, 10, 10], class_name: "ansi-black" },
                        { rgb: [187, 53, 53], class_name: "ansi-red" },
                        { rgb: [53, 187, 53], class_name: "ansi-green" },
                        { rgb: [187, 187, 53], class_name: "ansi-yellow" },
                        { rgb: [53, 53, 187], class_name: "ansi-blue" },
                        { rgb: [187, 53, 187], class_name: "ansi-magenta" },
                        { rgb: [53, 187, 187], class_name: "ansi-cyan" },
                        { rgb: [245, 245, 245], class_name: "ansi-white" },
                    ],
                    [
                        {
                            rgb: [110, 110, 110],
                            class_name: "ansi-bright-black",
                        },
                        { rgb: [255, 85, 85], class_name: "ansi-bright-red" },
                        {
                            rgb: [0, 255, 0],
                            class_name: "ansi-bright-green",
                        },
                        {
                            rgb: [255, 255, 85],
                            class_name: "ansi-bright-yellow",
                        },
                        { rgb: [85, 85, 255], class_name: "ansi-bright-blue" },
                        {
                            rgb: [255, 85, 255],
                            class_name: "ansi-bright-magenta",
                        },
                        { rgb: [85, 255, 255], class_name: "ansi-bright-cyan" },
                        {
                            rgb: [255, 255, 255],
                            class_name: "ansi-bright-white",
                        },
                    ],
                ];
                this.palette_256 = [];
                this.ansi_colors.forEach((palette) => {
                    palette.forEach((rec) => {
                        this.palette_256.push(rec);
                    });
                });
                let levels = [0, 95, 135, 175, 215, 255];
                for (let r = 0; r < 6; ++r) {
                    for (let g = 0; g < 6; ++g) {
                        for (let b = 0; b < 6; ++b) {
                            let col = {
                                rgb: [levels[r], levels[g], levels[b]],
                                class_name: "truecolor",
                            };
                            this.palette_256.push(col);
                        }
                    }
                }
                let grey_level = 8;
                for (let i = 0; i < 24; ++i, grey_level += 10) {
                    let gry = {
                        rgb: [grey_level, grey_level, grey_level],
                        class_name: "truecolor",
                    };
                    this.palette_256.push(gry);
                }
            }
            escape_txt_for_html(txt) {
                if (!this._escape_html) return txt;
                return txt.replace(/[&<>"']/gm, (str) => {
                    if (str === "&") return "&amp;";
                    if (str === "<") return "&lt;";
                    if (str === ">") return "&gt;";
                    if (str === '"') return "&quot;";
                    if (str === "'") return "&#x27;";
                });
            }
            append_buffer(txt) {
                var str = this._buffer + txt;
                this._buffer = str;
            }
            get_next_packet() {
                var pkt = {
                    kind: PacketKind.EOS,
                    text: "",
                    url: "",
                };
                var len = this._buffer.length;
                if (len == 0) return pkt;
                var pos = this._buffer.indexOf("\x1B");
                if (pos == -1) {
                    pkt.kind = PacketKind.Text;
                    pkt.text = this._buffer;
                    this._buffer = "";
                    return pkt;
                }
                if (pos > 0) {
                    pkt.kind = PacketKind.Text;
                    pkt.text = this._buffer.slice(0, pos);
                    this._buffer = this._buffer.slice(pos);
                    return pkt;
                }
                if (pos == 0) {
                    if (len < 3) {
                        pkt.kind = PacketKind.Incomplete;
                        return pkt;
                    }
                    var next_char = this._buffer.charAt(1);
                    if (
                        next_char != "[" &&
                        next_char != "]" &&
                        next_char != "("
                    ) {
                        pkt.kind = PacketKind.ESC;
                        pkt.text = this._buffer.slice(0, 1);
                        this._buffer = this._buffer.slice(1);
                        return pkt;
                    }
                    if (next_char == "[") {
                        if (!this._csi_regex) {
                            this._csi_regex = rgx(
                                templateObject_1 ||
                                    (templateObject_1 = __makeTemplateObject(
                                        [
                                            "\n                        ^                           # beginning of line\n                                                    #\n                                                    # First attempt\n                        (?:                         # legal sequence\n                          \u001B[                      # CSI\n                          ([<-?]?)              # private-mode char\n                          ([d;]*)                    # any digits or semicolons\n                          ([ -/]?               # an intermediate modifier\n                          [@-~])                # the command\n                        )\n                        |                           # alternate (second attempt)\n                        (?:                         # illegal sequence\n                          \u001B[                      # CSI\n                          [ -~]*                # anything legal\n                          ([\0-\u001F:])              # anything illegal\n                        )\n                    ",
                                        ],
                                        [
                                            "\n                        ^                           # beginning of line\n                                                    #\n                                                    # First attempt\n                        (?:                         # legal sequence\n                          \\x1b\\[                      # CSI\n                          ([\\x3c-\\x3f]?)              # private-mode char\n                          ([\\d;]*)                    # any digits or semicolons\n                          ([\\x20-\\x2f]?               # an intermediate modifier\n                          [\\x40-\\x7e])                # the command\n                        )\n                        |                           # alternate (second attempt)\n                        (?:                         # illegal sequence\n                          \\x1b\\[                      # CSI\n                          [\\x20-\\x7e]*                # anything legal\n                          ([\\x00-\\x1f:])              # anything illegal\n                        )\n                    ",
                                        ],
                                    )),
                            );
                        }
                        let match = this._buffer.match(this._csi_regex);
                        if (match === null) {
                            pkt.kind = PacketKind.Incomplete;
                            return pkt;
                        }
                        if (match[4]) {
                            pkt.kind = PacketKind.ESC;
                            pkt.text = this._buffer.slice(0, 1);
                            this._buffer = this._buffer.slice(1);
                            return pkt;
                        }
                        if (match[1] != "" || match[3] != "m")
                            pkt.kind = PacketKind.Unknown;
                        else pkt.kind = PacketKind.SGR;
                        pkt.text = match[2];
                        var rpos = match[0].length;
                        this._buffer = this._buffer.slice(rpos);
                        return pkt;
                    } else if (next_char == "]") {
                        if (len < 4) {
                            pkt.kind = PacketKind.Incomplete;
                            return pkt;
                        }
                        if (
                            this._buffer.charAt(2) != "8" ||
                            this._buffer.charAt(3) != ";"
                        ) {
                            pkt.kind = PacketKind.ESC;
                            pkt.text = this._buffer.slice(0, 1);
                            this._buffer = this._buffer.slice(1);
                            return pkt;
                        }
                        if (!this._osc_st) {
                            this._osc_st = rgxG(
                                templateObject_2 ||
                                    (templateObject_2 = __makeTemplateObject(
                                        [
                                            "\n                        (?:                         # legal sequence\n                          (\u001B\\)                    # ESC                           |                           # alternate\n                          (\u0007)                      # BEL (what xterm did)\n                        )\n                        |                           # alternate (second attempt)\n                        (                           # illegal sequence\n                          [\0-\u0006]                 # anything illegal\n                          |                           # alternate\n                          [\b-\u001A]                 # anything illegal\n                          |                           # alternate\n                          [\u001C-\u001F]                 # anything illegal\n                        )\n                    ",
                                        ],
                                        [
                                            "\n                        (?:                         # legal sequence\n                          (\\x1b\\\\)                    # ESC \\\n                          |                           # alternate\n                          (\\x07)                      # BEL (what xterm did)\n                        )\n                        |                           # alternate (second attempt)\n                        (                           # illegal sequence\n                          [\\x00-\\x06]                 # anything illegal\n                          |                           # alternate\n                          [\\x08-\\x1a]                 # anything illegal\n                          |                           # alternate\n                          [\\x1c-\\x1f]                 # anything illegal\n                        )\n                    ",
                                        ],
                                    )),
                            );
                        }
                        this._osc_st.lastIndex = 0;
                        {
                            let match = this._osc_st.exec(this._buffer);
                            if (match === null) {
                                pkt.kind = PacketKind.Incomplete;
                                return pkt;
                            }
                            if (match[3]) {
                                pkt.kind = PacketKind.ESC;
                                pkt.text = this._buffer.slice(0, 1);
                                this._buffer = this._buffer.slice(1);
                                return pkt;
                            }
                        }
                        {
                            let match = this._osc_st.exec(this._buffer);
                            if (match === null) {
                                pkt.kind = PacketKind.Incomplete;
                                return pkt;
                            }
                            if (match[3]) {
                                pkt.kind = PacketKind.ESC;
                                pkt.text = this._buffer.slice(0, 1);
                                this._buffer = this._buffer.slice(1);
                                return pkt;
                            }
                        }
                        if (!this._osc_regex) {
                            this._osc_regex = rgx(
                                templateObject_3 ||
                                    (templateObject_3 = __makeTemplateObject(
                                        [
                                            "\n                        ^                           # beginning of line\n                                                    #\n                        \u001B]8;                    # OSC Hyperlink\n                        [ -:<-~]*       # params (excluding ;)\n                        ;                           # end of params\n                        ([!-~]{0,512})        # URL capture\n                        (?:                         # ST\n                          (?:\u001B\\)                  # ESC                           |                           # alternate\n                          (?:\u0007)                    # BEL (what xterm did)\n                        )\n                        ([ -~]+)              # TEXT capture\n                        \u001B]8;;                   # OSC Hyperlink End\n                        (?:                         # ST\n                          (?:\u001B\\)                  # ESC                           |                           # alternate\n                          (?:\u0007)                    # BEL (what xterm did)\n                        )\n                    ",
                                        ],
                                        [
                                            "\n                        ^                           # beginning of line\n                                                    #\n                        \\x1b\\]8;                    # OSC Hyperlink\n                        [\\x20-\\x3a\\x3c-\\x7e]*       # params (excluding ;)\n                        ;                           # end of params\n                        ([\\x21-\\x7e]{0,512})        # URL capture\n                        (?:                         # ST\n                          (?:\\x1b\\\\)                  # ESC \\\n                          |                           # alternate\n                          (?:\\x07)                    # BEL (what xterm did)\n                        )\n                        ([\\x20-\\x7e]+)              # TEXT capture\n                        \\x1b\\]8;;                   # OSC Hyperlink End\n                        (?:                         # ST\n                          (?:\\x1b\\\\)                  # ESC \\\n                          |                           # alternate\n                          (?:\\x07)                    # BEL (what xterm did)\n                        )\n                    ",
                                        ],
                                    )),
                            );
                        }
                        let match = this._buffer.match(this._osc_regex);
                        if (match === null) {
                            pkt.kind = PacketKind.ESC;
                            pkt.text = this._buffer.slice(0, 1);
                            this._buffer = this._buffer.slice(1);
                            return pkt;
                        }
                        pkt.kind = PacketKind.OSCURL;
                        pkt.url = match[1];
                        pkt.text = match[2];
                        var rpos = match[0].length;
                        this._buffer = this._buffer.slice(rpos);
                        return pkt;
                    } else if (next_char == "(") {
                        pkt.kind = PacketKind.Unknown;
                        this._buffer = this._buffer.slice(3);
                        return pkt;
                    }
                }
            }
            ansi_to_html(txt) {
                this.append_buffer(txt);
                var blocks = [];
                while (true) {
                    var packet = this.get_next_packet();
                    if (
                        packet.kind == PacketKind.EOS ||
                        packet.kind == PacketKind.Incomplete
                    )
                        break;
                    if (
                        packet.kind == PacketKind.ESC ||
                        packet.kind == PacketKind.Unknown
                    )
                        continue;
                    if (packet.kind == PacketKind.Text)
                        blocks.push(
                            this.transform_to_html(this.with_state(packet)),
                        );
                    else if (packet.kind == PacketKind.SGR)
                        this.process_ansi(packet);
                    else if (packet.kind == PacketKind.OSCURL)
                        blocks.push(this.process_hyperlink(packet));
                }
                return blocks.join("");
            }
            with_state(pkt) {
                return {
                    bold: this.bold,
                    faint: this.faint,
                    italic: this.italic,
                    underline: this.underline,
                    fg: this.fg,
                    bg: this.bg,
                    text: pkt.text,
                };
            }
            process_ansi(pkt) {
                let sgr_cmds = pkt.text.split(";");
                while (sgr_cmds.length > 0) {
                    let sgr_cmd_str = sgr_cmds.shift();
                    let num = parseInt(sgr_cmd_str, 10);
                    if (isNaN(num) || num === 0) {
                        this.fg = null;
                        this.bg = null;
                        this.bold = false;
                        this.faint = false;
                        this.italic = false;
                        this.underline = false;
                    } else if (num === 1) {
                        this.bold = true;
                    } else if (num === 2) {
                        this.faint = true;
                    } else if (num === 3) {
                        this.italic = true;
                    } else if (num === 4) {
                        this.underline = true;
                    } else if (num === 21) {
                        this.bold = false;
                    } else if (num === 22) {
                        this.faint = false;
                        this.bold = false;
                    } else if (num === 23) {
                        this.italic = false;
                    } else if (num === 24) {
                        this.underline = false;
                    } else if (num === 39) {
                        this.fg = null;
                    } else if (num === 49) {
                        this.bg = null;
                    } else if (num >= 30 && num < 38) {
                        this.fg = this.ansi_colors[0][num - 30];
                    } else if (num >= 40 && num < 48) {
                        this.bg = this.ansi_colors[0][num - 40];
                    } else if (num >= 90 && num < 98) {
                        this.fg = this.ansi_colors[1][num - 90];
                    } else if (num >= 100 && num < 108) {
                        this.bg = this.ansi_colors[1][num - 100];
                    } else if (num === 38 || num === 48) {
                        if (sgr_cmds.length > 0) {
                            let is_foreground = num === 38;
                            let mode_cmd = sgr_cmds.shift();
                            if (mode_cmd === "5" && sgr_cmds.length > 0) {
                                let palette_index = parseInt(
                                    sgr_cmds.shift(),
                                    10,
                                );
                                if (
                                    palette_index >= 0 &&
                                    palette_index <= 255
                                ) {
                                    if (is_foreground)
                                        this.fg =
                                            this.palette_256[palette_index];
                                    else
                                        this.bg =
                                            this.palette_256[palette_index];
                                }
                            }
                            if (mode_cmd === "2" && sgr_cmds.length > 2) {
                                let r = parseInt(sgr_cmds.shift(), 10);
                                let g = parseInt(sgr_cmds.shift(), 10);
                                let b = parseInt(sgr_cmds.shift(), 10);
                                if (
                                    r >= 0 &&
                                    r <= 255 &&
                                    g >= 0 &&
                                    g <= 255 &&
                                    b >= 0 &&
                                    b <= 255
                                ) {
                                    let c = {
                                        rgb: [r, g, b],
                                        class_name: "truecolor",
                                    };
                                    if (is_foreground) this.fg = c;
                                    else this.bg = c;
                                }
                            }
                        }
                    }
                }
            }
            transform_to_html(fragment) {
                let txt = fragment.text;
                if (txt.length === 0) return txt;
                txt = this.escape_txt_for_html(txt);
                if (
                    !fragment.bold &&
                    !fragment.italic &&
                    !fragment.faint &&
                    !fragment.underline &&
                    fragment.fg === null &&
                    fragment.bg === null
                )
                    return txt;
                let styles = [];
                let classes = [];
                let fg = fragment.fg;
                let bg = fragment.bg;
                if (fragment.bold) styles.push(this._boldStyle);
                if (fragment.faint) styles.push(this._faintStyle);
                if (fragment.italic) styles.push(this._italicStyle);
                if (fragment.underline) styles.push(this._underlineStyle);
                if (!this._use_classes) {
                    if (fg) styles.push(`color:rgb(${fg.rgb.join(",")})`);
                    if (bg) styles.push(`background-color:rgb(${bg.rgb})`);
                } else {
                    if (fg) {
                        if (fg.class_name !== "truecolor") {
                            classes.push(`${fg.class_name}-fg`);
                        } else {
                            styles.push(`color:rgb(${fg.rgb.join(",")})`);
                        }
                    }
                    if (bg) {
                        if (bg.class_name !== "truecolor") {
                            classes.push(`${bg.class_name}-bg`);
                        } else {
                            styles.push(
                                `background-color:rgb(${bg.rgb.join(",")})`,
                            );
                        }
                    }
                }
                let class_string = "";
                let style_string = "";
                if (classes.length)
                    class_string = ` class="${classes.join(" ")}"`;
                if (styles.length)
                    style_string = ` style="${styles.join(";")}"`;
                return `<span${style_string}${class_string}>${txt}</span>`;
            }
            process_hyperlink(pkt) {
                let parts = pkt.url.split(":");
                if (parts.length < 1) return "";
                if (!this._url_allowlist[parts[0]]) return "";
                let result = `<a href="${this.escape_txt_for_html(pkt.url)}">${this.escape_txt_for_html(pkt.text)}</a>`;
                return result;
            }
        }
        function rgx(tmplObj, ...subst) {
            let regexText = tmplObj.raw[0];
            let wsrgx = /^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm;
            let txt2 = regexText.replace(wsrgx, "");
            return new RegExp(txt2);
        }
        function rgxG(tmplObj, ...subst) {
            let regexText = tmplObj.raw[0];
            let wsrgx = /^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm;
            let txt2 = regexText.replace(wsrgx, "");
            return new RegExp(txt2, "g");
        }
        var templateObject_1, templateObject_2, templateObject_3;

        function login() {
            let token = localStorage.getItem("token");
            if (token) {
                switchSvg();
                return token;
            }
            openModal();
            return undefined;
        }

        async function requestLogin(name, password) {
            let response = await fetch("/login", {
                method: "POST",
                headers: {
                    Authorization: `basic ${btoa(`${name}:${password}`)}`
                }
            });
            if (response.status >= 400) {
                throw new Error(`status code ${response.status}\n${await response.text()}`)
            }
            let token = await response.text()
            return token;
        }

        function getSocket() {
            var __socket__;
            return __socket__;
        }

        function getLogData() {
            let ansi_up = new AnsiUp();
            let text = "";
            let consoleDiv = document.getElementById("console");
            // remove all children
            while (consoleDiv.firstChild) {
              consoleDiv.removeChild(consoleDiv.firstChild);
            }
            let div = document.createElement("div");
            consoleDiv.appendChild(div);

            let auth = login();
            if (auth == undefined) {
                return;
            }

            let socket = getSocket();
            if (socket) {
                socket.close();
            }
            socket = new WebSocket("/ws/{{.FileName}}");

            socket.onopen = (event) => {
                socket.send(auth);
            };

            socket.onmessage = (event) => {
                text += event.data;
                let lines = text.split("\n");
                for (let line of lines) {
                    let cns = ansi_up.ansi_to_html(line);
                    if (cns) {
                        let element = document.createElement("div");
                        element.innerHTML = cns;
                        div.appendChild(element);
                    }
                }
                if (lines.length > 1) {
                    text = "";
                }
            };
        }

        function openModal() {
            document.getElementById("modal").classList.add("open");
            document.getElementById("modal").classList.remove("hide");
        }

        function closeModal() {
            document.getElementById("modal").classList.add("hide");
            document.getElementById("modal").classList.remove("open");
        }

        function hideError() {
            document.getElementById("credentials_error").classList.remove("show");
            document.getElementById("credentials_error").classList.add("hide");
        }

        function switchSvg() {
            document.getElementById("icon-login").classList.toggle("hide");
            document.getElementById("icon-logout").classList.toggle("hide");
        }

        function sendForm() {
            let name = document.getElementById("input_name").value;
            let password = document.getElementById("input_password").value;

            requestLogin(name, password).then(
                (token)=> {
                    localStorage.setItem("token", token);
                    closeModal();
                    getLogData();
                },
                (reason) => {
                    document.getElementById("credentials_error").classList.add("show");
                    return;
                }
            )
        }

        getLogData();
    </script>
</html>
